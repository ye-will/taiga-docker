data:
  image: tianon/true
  volumes:
    - /var/lib/postgresql/data
    - /taiga/media
    - /taiga/static
    - /taiga/logs

db:
  image: postgres
  environment:
    POSTGRES_USER: taiga
    POSTGRES_PASSWORD: password
  volumes_from:
    - data
  restart: always

taigaback:
  build: taiga-back
  environment:
    DB_HOST: postgres
    DB_PORT: 5432
    DB_NAME: taiga
    DB_USER: taiga
    DB_PASSWORD: password
    DOMAIN: 192.168.65.2:18000
    PUBLIC_REGISTER_ENABLED: 'False'
    EMAIL_USE_TLS: 'False'
    EMAIL_HOST: my.smtp.server
    EMAIL_PORT: 587
    EMAIL_HOST_USER: user
    EMAIL_HOST_PASSWORD: password
    DEFAULT_FROM_EMAIL: no-reply@taiga.io
  links:
    - db:postgres
  volumes_from:
    - data
  restart: always
  # entrypoint: sleep 1000000

taigafront:
  build: taiga-front-dist
  links:
    - taigaback
  volumes_from:
    - data
  ports:
    - 0.0.0.0:18000:80
  restart: always
